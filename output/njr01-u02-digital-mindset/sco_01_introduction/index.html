<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>مقدمة الوحدة | الذهنية الرقمية وممارسات الابتكار التقني</title>
  <link rel="stylesheet" href="../shared/base.css">
  <link rel="stylesheet" href="../shared/theme.css">
  <link rel="stylesheet" href="../shared/course-custom.css">
</head>
<body>
  <a href="#main-content" class="skip-nav">تخطي إلى المحتوى الرئيسي</a>

  <div class="sco-container">
    <!-- Top Navigation Bar -->
    <header class="nav-bar">
      <span class="course-title">الذهنية الرقمية وممارسات الابتكار التقني</span>
      <div class="points-badge elastic-click" id="pointsBadge" aria-label="النقاط">
        <span>&#11088;</span>
        <span class="points-count" id="pointsDisplay">0</span>
      </div>
    </header>

    <!-- Progress Bar -->
    <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
      <div class="progress-fill" id="progressFill"></div>
    </div>

    <!-- Main Content Area -->
    <main class="sco-content" id="main-content">

      <!-- Slide 1: Welcome / Hero -->
      <div class="slide" data-slide="0">
        <div class="slide-inner">
          <div class="hero-section has-grain text-center stagger-item" style="padding: 48px 32px;">
            <p style="font-size: var(--font-size-small); opacity: 0.9; margin-bottom: 8px;">جامعة نجران — كلية علوم الحاسب ونظم المعلومات</p>
            <h1 class="display-text" style="color: white; margin-bottom: 16px;">الذهنية الرقمية وممارسات الابتكار التقني</h1>
            <p style="font-size: 1.15rem; color: rgba(255,255,255,0.9); margin-bottom: 24px;">
              هل فكرت يومًا كيف تحوّل فكرة إلى مشروع ناجح؟
            </p>
            <p class="text-small" style="color: rgba(255,255,255,0.7);">
              <span class="ltr-inline">NJR01-U02</span> &bull; الوحدة الثانية
            </p>
          </div>
        </div>
      </div>

      <!-- Slide 2: Learning Objectives (Flip Cards) -->
      <div class="slide" data-slide="1">
        <div class="slide-inner align-top">
          <h2 class="stagger-item" style="text-align: center; margin-bottom: 8px;">بعد هذه الوحدة، ستتمكن من...</h2>
          <p class="text-secondary text-center stagger-item" style="margin-bottom: 20px;">اضغط على كل بطاقة لمعرفة تفاصيل الهدف</p>

          <div class="objectives-grid">
            <div class="flip-card hover-lift stagger-item" onclick="this.classList.toggle('flipped')" role="button" tabindex="0"
                 aria-label="الهدف 1 — اضغط للقلب"
                 onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();this.classList.toggle('flipped')}">
              <div class="flip-card-inner">
                <div class="flip-card-front">
                  <span style="font-size:2rem">1</span>
                  <h4 style="color:white; margin:8px 0 0">تذكر</h4>
                </div>
                <div class="flip-card-back">
                  <p style="font-size:15px">تعداد عناصر الابتكار الثلاثة وتقنيات العصف الذهني <span class="ltr-inline">(Brainstorming)</span> الأساسية</p>
                </div>
              </div>
            </div>

            <div class="flip-card hover-lift stagger-item" onclick="this.classList.toggle('flipped')" role="button" tabindex="0"
                 aria-label="الهدف 2 — اضغط للقلب"
                 onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();this.classList.toggle('flipped')}">
              <div class="flip-card-inner">
                <div class="flip-card-front">
                  <span style="font-size:2rem">2</span>
                  <h4 style="color:white; margin:8px 0 0">فهم</h4>
                </div>
                <div class="flip-card-back">
                  <p style="font-size:15px">شرح مفهوم ريادة الأعمال <span class="ltr-inline">(Entrepreneurship)</span> وعلاقتها بالابتكار التقني</p>
                </div>
              </div>
            </div>

            <div class="flip-card hover-lift stagger-item" onclick="this.classList.toggle('flipped')" role="button" tabindex="0"
                 aria-label="الهدف 3 — اضغط للقلب"
                 onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();this.classList.toggle('flipped')}">
              <div class="flip-card-inner">
                <div class="flip-card-front">
                  <span style="font-size:2rem">3</span>
                  <h4 style="color:white; margin:8px 0 0">فهم</h4>
                </div>
                <div class="flip-card-back">
                  <p style="font-size:15px">شرح المراحل الخمس للتفكير التصميمي <span class="ltr-inline">(Design Thinking)</span> ودور كل مرحلة</p>
                </div>
              </div>
            </div>

            <div class="flip-card hover-lift stagger-item" onclick="this.classList.toggle('flipped')" role="button" tabindex="0"
                 aria-label="الهدف 4 — اضغط للقلب"
                 onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();this.classList.toggle('flipped')}">
              <div class="flip-card-inner">
                <div class="flip-card-front">
                  <span style="font-size:2rem">4</span>
                  <h4 style="color:white; margin:8px 0 0">تطبيق</h4>
                </div>
                <div class="flip-card-back">
                  <p style="font-size:15px">تطبيق طريقة <span class="ltr-inline">SCAMPER</span> لتوليد أفكار إبداعية جديدة</p>
                </div>
              </div>
            </div>

            <div class="flip-card hover-lift stagger-item" onclick="this.classList.toggle('flipped')" role="button" tabindex="0"
                 aria-label="الهدف 5 — اضغط للقلب"
                 onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();this.classList.toggle('flipped')}">
              <div class="flip-card-inner">
                <div class="flip-card-front">
                  <span style="font-size:2rem">5</span>
                  <h4 style="color:white; margin:8px 0 0">تطبيق</h4>
                </div>
                <div class="flip-card-back">
                  <p style="font-size:15px">استخدام مراحل التفكير التصميمي لبناء نموذج أولي <span class="ltr-inline">(Prototype)</span></p>
                </div>
              </div>
            </div>

            <div class="flip-card hover-lift stagger-item" onclick="this.classList.toggle('flipped')" role="button" tabindex="0"
                 aria-label="الهدف 6 — اضغط للقلب"
                 onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();this.classList.toggle('flipped')}">
              <div class="flip-card-inner">
                <div class="flip-card-front">
                  <span style="font-size:2rem">6</span>
                  <h4 style="color:white; margin:8px 0 0">تحليل</h4>
                </div>
                <div class="flip-card-back">
                  <p style="font-size:15px">تحليل العلاقة بين التكنولوجيا وملاءمة السوق <span class="ltr-inline">(Technology-Market Fit)</span></p>
                </div>
              </div>
            </div>

            <div class="flip-card hover-lift stagger-item" onclick="this.classList.toggle('flipped')" role="button" tabindex="0"
                 aria-label="الهدف 7 — اضغط للقلب"
                 onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();this.classList.toggle('flipped')}">
              <div class="flip-card-inner">
                <div class="flip-card-front">
                  <span style="font-size:2rem">7</span>
                  <h4 style="color:white; margin:8px 0 0">تقييم</h4>
                </div>
                <div class="flip-card-back">
                  <p style="font-size:15px">تقييم الفرص الريادية بناءً على معايير محددة</p>
                </div>
              </div>
            </div>

            <div class="flip-card hover-lift stagger-item" onclick="this.classList.toggle('flipped')" role="button" tabindex="0"
                 aria-label="الهدف 8 — اضغط للقلب"
                 onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();this.classList.toggle('flipped')}">
              <div class="flip-card-inner">
                <div class="flip-card-front">
                  <span style="font-size:2rem">8</span>
                  <h4 style="color:white; margin:8px 0 0">إبداع</h4>
                </div>
                <div class="flip-card-back">
                  <p style="font-size:15px">تصميم حل ابتكاري لمشكلة رقمية واقعية</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 3: Learning Journey Map -->
      <div class="slide" data-slide="2">
        <div class="slide-inner">
          <h2 class="text-center stagger-item">خريطة رحلة التعلم</h2>
          <p class="text-secondary text-center stagger-item" style="margin-bottom: 24px;">رحلتك من أساسيات الابتكار إلى تحويل الأفكار لمشاريع حقيقية</p>

          <div class="journey-map stagger-item" role="list" aria-label="خطوات رحلة التعلم">
            <div style="text-align:center" role="listitem">
              <div class="journey-node active" aria-label="مقدمة — الخطوة الحالية">&#9733;</div>
              <div class="journey-label">مقدمة</div>
            </div>
            <div style="text-align:center" role="listitem">
              <div class="journey-node" aria-label="اختبار قبلي">&#63;</div>
              <div class="journey-label">اختبار قبلي</div>
            </div>
            <div style="text-align:center" role="listitem">
              <div class="journey-node" aria-label="أساسيات الابتكار">1</div>
              <div class="journey-label">أساسيات الابتكار</div>
            </div>
            <div style="text-align:center" role="listitem">
              <div class="journey-node" aria-label="عقلية الابتكار">2</div>
              <div class="journey-label">عقلية الابتكار</div>
            </div>
            <div style="text-align:center" role="listitem">
              <div class="journey-node" aria-label="من الفكرة إلى السوق">3</div>
              <div class="journey-label">الفكرة للسوق</div>
            </div>
            <div style="text-align:center" role="listitem">
              <div class="journey-node" aria-label="أنشطة تفاعلية">&#9881;</div>
              <div class="journey-label">أنشطة</div>
            </div>
            <div style="text-align:center" role="listitem">
              <div class="journey-node" aria-label="اختبار بعدي">&#10003;</div>
              <div class="journey-label">اختبار بعدي</div>
            </div>
          </div>

          <div class="callout callout-info stagger-item" style="margin-top: 24px;">
            <span class="callout-icon" aria-hidden="true">&#128161;</span>
            <div>
              <strong>المدة المتوقعة:</strong> ~2.5 ساعة تعلم تفاعلي عبر 3 وحدات تعليمية + أنشطة تطبيقية + اختبار شامل.
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 4: Navigation Guide (Tabs) -->
      <div class="slide" data-slide="3">
        <div class="slide-inner">
          <h2 class="text-center stagger-item">كيف تتنقل في هذه الوحدة؟</h2>

          <div class="tabs-container stagger-item" style="margin-top: 20px;">
            <div class="tabs" role="tablist" aria-label="دليل التنقل">
              <button class="tab active" role="tab" aria-selected="true" aria-controls="nav-panel-1" id="nav-tab-1" onclick="switchTab(this, 'nav-panel-1')">التنقل</button>
              <button class="tab" role="tab" aria-selected="false" aria-controls="nav-panel-2" id="nav-tab-2" onclick="switchTab(this, 'nav-panel-2')">النقاط والشارات</button>
              <button class="tab" role="tab" aria-selected="false" aria-controls="nav-panel-3" id="nav-tab-3" onclick="switchTab(this, 'nav-panel-3')">نصائح للنجاح</button>
            </div>

            <div class="tab-content active" role="tabpanel" id="nav-panel-1" aria-labelledby="nav-tab-1">
              <div class="card shadow-sm" style="margin-bottom: 12px;">
                <h4>&#9664; &#9654; أزرار التالي والسابق</h4>
                <p>استخدم الأزرار أسفل الشاشة للتنقل بين الشرائح. يمكنك أيضًا استخدام أسهم لوحة المفاتيح أو السحب على الشاشة.</p>
              </div>
              <div class="card shadow-sm">
                <h4>&#9632; شريط التقدم</h4>
                <p>يظهر في أعلى الشاشة ويوضح مدى تقدمك في كل درس. أكمل جميع الشرائح للانتقال للدرس التالي.</p>
              </div>
            </div>

            <div class="tab-content" role="tabpanel" id="nav-panel-2" aria-labelledby="nav-tab-2">
              <div class="card shadow-sm" style="margin-bottom: 12px;">
                <h4>&#11088; نظام النقاط</h4>
                <p>اكسب نقاطًا عند إكمال الدروس والإجابة الصحيحة على الأسئلة. كلما أجبت بشكل صحيح متتالٍ، حصلت على مكافأة إضافية!</p>
              </div>
              <div class="card shadow-sm">
                <h4>&#127942; الشارات</h4>
                <p>اجمع 8 شارات مختلفة أثناء رحلتك — من «بداية الرحلة» إلى «خبير الابتكار» عند تحقيق درجة كاملة.</p>
              </div>
            </div>

            <div class="tab-content" role="tabpanel" id="nav-panel-3" aria-labelledby="nav-tab-3">
              <div class="card shadow-sm" style="margin-bottom: 12px;">
                <h4>&#128218; تفاعل مع المحتوى</h4>
                <p>اضغط على البطاقات، افتح الأقسام، وجرّب الأنشطة التفاعلية. كلما تفاعلت أكثر، تعلمت أعمق.</p>
              </div>
              <div class="card shadow-sm">
                <h4>&#128170; عقلية النمو</h4>
                <p>لا تقلق من الإجابات الخاطئة — كل خطأ هو فرصة للتعلم! ستحصل على تغذية راجعة مفصلة تساعدك على الفهم.</p>
              </div>
            </div>
          </div>

          <div class="callout callout-success stagger-item" style="margin-top: 20px;">
            <span class="callout-icon" aria-hidden="true">&#127775;</span>
            <div>
              <strong>هل أنت جاهز؟</strong> اضغط «التالي» لبدء رحلة الابتكار!
            </div>
          </div>
        </div>
      </div>

    </main>

    <!-- Bottom Navigation -->
    <nav class="sco-nav" aria-label="تنقل الدرس">
      <button class="btn-prev elastic-click" id="prevBtn" disabled data-next-text="السابق">السابق</button>
      <span class="page-indicator" id="pageIndicator">1 / 4</span>
      <button class="btn-next elastic-click" id="nextBtn" data-next-text="التالي" data-complete-text="إكمال">التالي</button>
    </nav>
  </div>

  <!-- Scripts -->
  <script src="../shared/scorm-api.js"></script>
  <script src="../shared/engine/slide-controller.js"></script>
  <script src="../shared/engine/sound-effects.js"></script>
  <script src="../shared/engine/confetti.js"></script>
  <script src="../shared/engine/achievement-system.js"></script>
  <script src="../shared/behavior-tracker.js"></script>
  <script src="../shared/gamification.js"></script>

  <script>
  (function() {
    'use strict';

    // --- Tab switching ---
    window.switchTab = function(btn, panelId) {
      var tabs = btn.parentElement.querySelectorAll('.tab');
      tabs.forEach(function(t) {
        t.classList.remove('active');
        t.setAttribute('aria-selected', 'false');
      });
      var panels = btn.closest('.tabs-container').querySelectorAll('.tab-content');
      panels.forEach(function(p) { p.classList.remove('active'); });
      btn.classList.add('active');
      btn.setAttribute('aria-selected', 'true');
      document.getElementById(panelId).classList.add('active');
    };

    // --- SCORM Init ---
    var scorm = new SCORMWrapper();
    scorm.initialize();

    // Check current status before setting
    var currentStatus = scorm.getValue('cmi.core.lesson_status');
    if (!currentStatus || currentStatus === 'not attempted') {
      scorm.setValue('cmi.core.lesson_status', 'incomplete');
    }

    // --- Sound Effects ---
    var sounds = new SoundEffects();

    // --- Confetti ---
    var confetti = new Confetti();

    // --- Gamification ---
    var points = 0;
    var pointsDisplay = document.getElementById('pointsDisplay');
    var pointsBadge = document.getElementById('pointsBadge');

    // Load saved points from suspend_data
    try {
      var savedData = scorm.getValue('cmi.suspend_data');
      if (savedData) {
        var parsed = JSON.parse(savedData);
        if (parsed.points) {
          points = parsed.points;
          pointsDisplay.textContent = points;
        }
      }
    } catch(e) { /* start fresh */ }

    function awardPoints(amount) {
      points += amount;
      pointsDisplay.textContent = points;
      pointsBadge.classList.add('glow');
      setTimeout(function() { pointsBadge.classList.remove('glow'); }, 600);
    }

    // --- Start time ---
    var startTime = new Date();

    // --- Slide Controller ---
    var slideController = new SlideController({
      onSlideChange: function(index, total) {
        sounds.playSound('whoosh');
      },
      onComplete: function() {
        // Award completion points
        awardPoints(10);
        sounds.playSound('celebration');
        confetti.fire();

        // Set SCORM status
        scorm.setValue('cmi.core.lesson_status', 'completed');

        // Save session time
        var duration = Math.floor((new Date() - startTime) / 1000);
        var h = Math.floor(duration / 3600);
        var m = Math.floor((duration % 3600) / 60);
        var s = duration % 60;
        scorm.setValue('cmi.core.session_time',
          (h < 10 ? '0' : '') + h + ':' + (m < 10 ? '0' : '') + m + ':' + (s < 10 ? '0' : '') + s);

        // Save state
        try {
          scorm.setValue('cmi.suspend_data', JSON.stringify({ points: points, completed: true }));
        } catch(e) {}

        scorm.commit();
      }
    });

    // Resume from bookmark if available
    var bookmark = scorm.getValue('cmi.core.lesson_location');
    if (bookmark) {
      var savedSlide = parseInt(bookmark, 10);
      if (!isNaN(savedSlide) && savedSlide > 0) {
        slideController.resumeFrom(savedSlide);
      }
    }

    // Save bookmark on unload
    window.addEventListener('beforeunload', function() {
      scorm.setValue('cmi.core.lesson_location', String(slideController.currentIndex));
      scorm.commit();
    });

  })();
  </script>
</body>
</html>
